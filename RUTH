RUTH
srun -N 1 --cpus-per-task=32 --mem 80G --time=72:00:00 --pty bash
module load anaconda/python3
source activate Mosaic
cd ~/Mosaic/Mosaic/pipes/
snakemake --use-conda --config input_dir=/hpcfs/home/rd.hernandez/DatosRuth-Shotgun/2.VIRUS/Viral_Analysis/00_RAW_READS/ results_dir=/hpcfs/home/rd.hernandez/DatosRuth-Shotgun/2.VIRUS/Viral_Analysis/ forward_tag=R1_001 reverse_tag=R2_001 contaminants_list="GCF_000001405.39 GCF_002263795.1" -k -j 16


wget $(esearch -db "assembly" -query $contaminant | esummary | xtract -pattern DocumentSummary -element FtpPath_RefSeq | awk -F"/" '{{print $0"/"$NF"_genomic.fna.gz"}}')

bmtool -d /hpcfs/home/rd.hernandez/DatosRuth-Shotgun/2.VIRUS/Viral_Analysis/db/contaminants/GCF_000819615.1.fasta-o  /hpcfs/home/rd.hernandez/DatosRuth-Shotgun/2.VIRUS/Viral_Analysis/db/GCF_000819615.1.bitmask  -w 18 -z
srprism mkindex -i {output.contaminant_fasta} -o {output.contaminant_srprism} -M {resources.mem_mb}


mkdir /hpcfs/home/rd.hernandez/DatosRuth-Shotgun/2.VIRUS/Viral_Analysis/02_CLEAN_DATA/Gordon_N822_S526_CCACGGCC_CCGGTACG_S7-GCF_002263795.1_temp
bmtagger.sh -b /hpcfs/home/rd.hernandez/DatosRuth-Shotgun/2.VIRUS/Viral_Analysis/db/contaminants/GCF_002263795.1.bitmask -x /hpcfs/home/rd.hernandez/DatosRuth-Shotgun/2.VIRUS/Viral_Analysis/db/contaminants/GCF_002263795.1.srprism -T /hpcfs/home/rd.hernandez/DatosRuth-Shotgun/2.VIRUS/Viral_Analysis/02_CLEAN_DATA/Gordon_N822_S526_CCACGGCC_CCGGTACG_S7-GCF_002263795.1_temp -q 1 -1 /hpcfs/home/rd.hernandez/DatosRuth-Shotgun/2.VIRUS/Viral_Analysis/02_CLEAN_DATA/Gordon_N822_S526_CCACGGCC_CCGGTACG_S7_forward_paired.fastq -2 /hpcfs/home/rd.hernandez/DatosRuth-Shotgun/2.VIRUS/Viral_Analysis/02_CLEAN_DATA/Gordon_N822_S526_CCACGGCC_CCGGTACG_S7_reverse_paired.fastq -o /hpcfs/home/rd.hernandez/DatosRuth-Shotgun/2.VIRUS/Viral_Analysis/02_CLEAN_DATA/Gordon_N822_S526_CCACGGCC_CCGGTACG_S7-GCF_002263795.1-BMTagger.txt
